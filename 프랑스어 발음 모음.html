<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Bon Son - í”„ë‘ìŠ¤ì–´ ë°œìŒ ì—°ìŠµ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: #333;
        }
        .container {
            width: 90%;
            max-width: 500px;
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        h1 {
            color: #4a69bd;
            margin-bottom: 20px;
        }
        #practiceCard {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        #frenchText {
            font-size: 2em;
            font-weight: bold;
            color: #1e3799;
            margin-bottom: 10px;
        }
        #koreanText {
            font-size: 1em;
            color: #777;
            margin-bottom: 20px;
        }
        .buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        button {
            padding: 15px 25px;
            font-size: 1.2em;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            color: white;
            transition: background-color 0.3s;
        }
        #listenBtn { background-color: #4a69bd; }
        #listenBtn:hover { background-color: #3a539b; }
        #speakBtn { background-color: #e67e22; }
        #speakBtn.recording { background-color: #c0392b; animation: pulse 1.5s infinite; }
        #nextBtn { background-color: #27ae60; }
        #nextBtn:hover { background-color: #229954; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(192, 57, 43, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(192, 57, 43, 0); }
            100% { box-shadow: 0 0 0 0 rgba(192, 57, 43, 0); }
        }

        #resultArea {
            min-height: 50px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        #userSaid {
            font-size: 1.2em;
            font-weight: 500;
        }
        .correct { color: #27ae60; }
        .incorrect { color: #c0392b; }
    </style>
</head>
<body>

<div class="container">
    <h1>Le Bon Son ğŸ‡«ğŸ‡·</h1>
    <div id="practiceCard">
        <h2 id="frenchText">Bonjour</h2>
        <p id="koreanText">(ì•ˆë…•í•˜ì„¸ìš”)</p>
    </div>
    <div class="buttons">
        <button id="listenBtn">ğŸ”Š ë“£ê¸°</button>
        <button id="speakBtn">ğŸ¤ ë§í•˜ê¸°</button>
    </div>
    <div id="resultArea">
        <p>ë§ˆì´í¬ ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ë”°ë¼ ë§í•´ë³´ì„¸ìš”.</p>
        <p id="userSaid"></p>
    </div>
     <button id="nextBtn">ë‹¤ìŒ ë¬¸ì œ â†’</button>
</div>

<script>
    // --- ë°ì´í„° ---
    const practiceData = [
        { french: "Bonjour", korean: "(ì•ˆë…•í•˜ì„¸ìš”)" },
        { french: "Je m'appelle", korean: "(ì œ ì´ë¦„ì€...)" },
        { french: "Comment Ã§a va ?", korean: "(ì–´ë–»ê²Œ ì§€ë‚´ì„¸ìš”?)" },
        { french: "Merci beaucoup", korean: "(ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤)" },
        { french: "Les Champs-Ã‰lysÃ©es", korean: "(ìƒ¹ì ¤ë¦¬ì œ)" },
        { french: "poisson", korean: "(ë¬¼ê³ ê¸°)" },
        { french: "poison", korean: "(ë…)" },
    ];
    let currentIndex = 0;

    // --- HTML ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° ---
    const frenchTextElem = document.getElementById('frenchText');
    const koreanTextElem = document.getElementById('koreanText');
    const listenBtn = document.getElementById('listenBtn');
    const speakBtn = document.getElementById('speakBtn');
    const nextBtn = document.getElementById('nextBtn');
    const resultArea = document.getElementById('resultArea');
    const userSaidElem = document.getElementById('userSaid');

    // --- ìŒì„± í•©ì„±(TTS) ì„¤ì • ---
    const synth = window.speechSynthesis;
    
    // --- ìŒì„± ì¸ì‹ ì„¤ì • ---
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = new SpeechRecognition();
    recognition.lang = 'fr-FR'; // í”„ë‘ìŠ¤ì–´ë¡œ ì„¤ì •
    recognition.interimResults = false;

    // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
    listenBtn.addEventListener('click', () => {
        const textToSpeak = frenchTextElem.textContent;
        const utterThis = new SpeechSynthesisUtterance(textToSpeak);
        utterThis.lang = 'fr-FR'; // í”„ë‘ìŠ¤ì–´ ëª©ì†Œë¦¬
        utterThis.rate = 0.8; // ì•½ê°„ ëŠë¦° ì†ë„
        synth.speak(utterThis);
    });

    speakBtn.addEventListener('click', () => {
        speakBtn.classList.add('recording');
        speakBtn.textContent = "ğŸ™ï¸ ë“£ëŠ” ì¤‘...";
        speakBtn.disabled = true;
        recognition.start();
    });
    
    nextBtn.addEventListener('click', loadNextProblem);

    // --- ìŒì„± ì¸ì‹ ê²°ê³¼ ì²˜ë¦¬ ---
    recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        userSaidElem.textContent = `ğŸ—£ï¸ "${transcript}"`;

        // ì •ë‹µ ë¹„êµ (ê°„ë‹¨í•œ ë²„ì „)
        const originalText = frenchTextElem.textContent.toLowerCase().replace(/[?.,]/g, '');
        const recognizedText = transcript.toLowerCase().replace(/[?.,]/g, '');

        if (originalText === recognizedText) {
            userSaidElem.className = 'correct';
            resultArea.firstChild.textContent = "ğŸ‰ ì •í™•í•´ìš”!";
        } else {
            userSaidElem.className = 'incorrect';
            resultArea.firstChild.textContent = "ğŸ¤” ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”!";
        }
    };

    recognition.onend = () => {
        speakBtn.classList.remove('recording');
        speakBtn.textContent = "ğŸ¤ ë§í•˜ê¸°";
        speakBtn.disabled = false;
    };

    recognition.onerror = (event) => {
        resultArea.firstChild.textContent = "ì—ëŸ¬ê°€ ë°œìƒí–ˆì–´ìš”: " + event.error;
        recognition.onend(); // ë²„íŠ¼ ìƒíƒœ ë³µêµ¬
    };

    // --- ë¬¸ì œ ë¡œë”© í•¨ìˆ˜ ---
    function loadNextProblem() {
        currentIndex = (currentIndex + 1) % practiceData.length;
        const problem = practiceData[currentIndex];
        frenchTextElem.textContent = problem.french;
        koreanTextElem.textContent = problem.korean;
        resultArea.firstChild.textContent = "ë§ˆì´í¬ ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ë”°ë¼ ë§í•´ë³´ì„¸ìš”.";
        userSaidElem.textContent = "";
        userSaidElem.className = "";
    }

</script>

</body>
</html>